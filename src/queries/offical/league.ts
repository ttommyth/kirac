import { League } from "@prisma/client";
import axios from "axios";
import { last } from "lodash";

export const fetchLeague: ()=>Promise<League[]> = async ()=>{
  //TODO: placeholder before GGG oauth team reply
  return ((
    {"leagues":[{"id":"Standard","realm":"pc","url":"https://www.pathofexile.com/ladders/league/Standard","startAt":"2013-01-23T21:00:00Z","endAt":null,"description":"The default game mode.","registerAt":"2019-09-06T19:00:00Z","delveEvent":true,"rules":[]},{"id":"Hardcore","realm":"pc","url":"https://www.pathofexile.com/ladders/league/Hardcore","startAt":"2013-01-23T21:00:00Z","endAt":null,"description":"A character killed in the Hardcore league is moved to the Standard league.","registerAt":"2019-09-06T19:00:00Z","delveEvent":true,"rules":[{"id":"Hardcore","name":"Hardcore","description":"A character killed in Hardcore is moved to its parent league."}]},{"id":"SSF Standard","realm":"pc","url":"https://www.pathofexile.com/ladders/league/SSF+Standard","startAt":"2013-01-23T21:00:00Z","endAt":null,"description":"SSF Standard","registerAt":"2019-09-06T19:00:00Z","delveEvent":true,"rules":[{"id":"NoParties","name":"Solo","description":"You may not party in this league."}]},{"id":"SSF Hardcore","realm":"pc","url":"https://www.pathofexile.com/ladders/league/SSF+Hardcore","startAt":"2013-01-23T21:00:00Z","endAt":null,"description":"SSF Hardcore","registerAt":"2019-09-06T19:00:00Z","delveEvent":true,"rules":[{"id":"Hardcore","name":"Hardcore","description":"A character killed in Hardcore is moved to its parent league."},{"id":"NoParties","name":"Solo","description":"You may not party in this league."}]},{"id":"Kalandra","realm":"pc","url":"https://www.pathofexile.com/ladders/league/Kalandra","startAt":"2022-08-19T20:00:00Z","endAt":"2025-08-19T23:00:00Z","description":"Travel to the Lake of Kalandra and defeat reflections of Wraeclast.\n\nThis is the default Path of Exile league.","registerAt":"2022-08-19T17:30:00Z","delveEvent":true,"rules":[]},{"id":"Hardcore Kalandra","realm":"pc","url":"https://www.pathofexile.com/ladders/league/Hardcore+Kalandra","startAt":"2022-08-19T20:00:00Z","endAt":"2025-08-19T23:00:00Z","description":"Travel to the Lake of Kalandra and defeat reflections of Wraeclast.\n\nA character killed in Hardcore Kalandra becomes a Standard character.","registerAt":"2022-08-19T17:30:00Z","delveEvent":true,"rules":[{"id":"Hardcore","name":"Hardcore","description":"A character killed in Hardcore is moved to its parent league."}]},{"id":"SSF Kalandra","realm":"pc","url":"https://www.pathofexile.com/ladders/league/SSF+Kalandra","startAt":"2022-08-19T20:00:00Z","endAt":"2025-08-19T23:00:00Z","description":"SSF Kalandra","registerAt":"2022-08-19T17:30:00Z","delveEvent":true,"rules":[{"id":"NoParties","name":"Solo","description":"You may not party in this league."}]},{"id":"SSF Kalandra HC","realm":"pc","url":"https://www.pathofexile.com/ladders/league/SSF+Kalandra+HC","startAt":"2022-08-19T20:00:00Z","endAt":"2025-08-19T23:00:00Z","description":"SSF HC Kalandra","registerAt":"2022-08-19T17:30:00Z","timedEvent":true,"delveEvent":true,"rules":[{"id":"Hardcore","name":"Hardcore","description":"A character killed in Hardcore is moved to its parent league."},{"id":"NoParties","name":"Solo","description":"You may not party in this league."}]},{"id":"Mayhem (NRE001)","realm":"pc","url":"https://www.pathofexile.com/ladders/league/Mayhem+%28NRE001%29","startAt":"2022-11-04T20:00:00Z","endAt":"2022-11-14T20:00:00Z","description":"Please check the Event Forums for more details.","registerAt":"2022-11-04T19:30:00Z","event":true,"rules":[{"id":"NoAscendancyClassRespecs","name":"No Ascendancy respecs","description":"You cannot change your Ascendancy class once it has been chosen."}]},{"id":"Mayhem HC (NRE002)","realm":"pc","url":"https://www.pathofexile.com/ladders/league/Mayhem+HC+%28NRE002%29","startAt":"2022-11-04T20:00:00Z","endAt":"2022-11-14T20:00:00Z","description":"Please check the Event Forums for more details.","registerAt":"2022-11-04T19:30:00Z","event":true,"rules":[{"id":"Hardcore","name":"Hardcore","description":"A character killed in Hardcore is moved to its parent league."},{"id":"NoAscendancyClassRespecs","name":"No Ascendancy respecs","description":"You cannot change your Ascendancy class once it has been chosen."}]},{"id":"Mayhem SSF (NRE003)","realm":"pc","url":"https://www.pathofexile.com/ladders/league/Mayhem+SSF+%28NRE003%29","startAt":"2022-11-04T20:00:00Z","endAt":"2022-11-14T20:00:00Z","description":"Please check the Event Forums for more details.","registerAt":"2022-11-04T19:30:00Z","event":true,"rules":[{"id":"NoParties","name":"Solo","description":"You may not party in this league."},{"id":"NoAscendancyClassRespecs","name":"No Ascendancy respecs","description":"You cannot change your Ascendancy class once it has been chosen."}]},{"id":"Mayhem HC SSF (NRE004)","realm":"pc","url":"https://www.pathofexile.com/ladders/league/Mayhem+HC+SSF+%28NRE004%29","startAt":"2022-11-04T20:00:00Z","endAt":"2022-11-14T20:00:00Z","description":"Please check the Event Forums for more details.","registerAt":"2022-11-04T19:30:00Z","event":true,"rules":[{"id":"Hardcore","name":"Hardcore","description":"A character killed in Hardcore is moved to its parent league."},{"id":"NoParties","name":"Solo","description":"You may not party in this league."},{"id":"NoAscendancyClassRespecs","name":"No Ascendancy respecs","description":"You cannot change your Ascendancy class once it has been chosen."}]},{"id":"Endless Delve SSF (NRE005)","realm":"pc","url":"https://www.pathofexile.com/ladders/league/Endless+Delve+SSF+%28NRE005%29","startAt":"2022-11-14T20:00:00Z","endAt":"2022-11-21T20:00:00Z","description":"Please check the Event Forums for more details.","registerAt":"2022-11-14T19:30:00Z","event":true,"timedEvent":true,"delveEvent":true,"rules":[{"id":"NoParties","name":"Solo","description":"You may not party in this league."},{"id":"NoAscendancyClassRespecs","name":"No Ascendancy respecs","description":"You cannot change your Ascendancy class once it has been chosen."}]},{"id":"Endless Delve HC SSF (NRE006)","realm":"pc","url":"https://www.pathofexile.com/ladders/league/Endless+Delve+HC+SSF+%28NRE006%29","startAt":"2022-11-14T20:00:00Z","endAt":"2022-11-21T20:00:00Z","description":"Please check the Event Forums for more details.","registerAt":"2022-11-14T19:30:00Z","event":true,"timedEvent":true,"delveEvent":true,"rules":[{"id":"Hardcore","name":"Hardcore","description":"A character killed in Hardcore is moved to its parent league."},{"id":"NoParties","name":"Solo","description":"You may not party in this league."},{"id":"NoAscendancyClassRespecs","name":"No Ascendancy respecs","description":"You cannot change your Ascendancy class once it has been chosen."}]},{"id":"Delirium Everywhere (NRE007)","realm":"pc","url":"https://www.pathofexile.com/ladders/league/Delirium+Everywhere+%28NRE007%29","startAt":"2022-11-21T20:00:00Z","endAt":"2022-11-28T20:00:00Z","description":"Please check the Event Forums for more details.","registerAt":"2022-11-21T19:30:00Z","event":true,"rules":[{"id":"NoAscendancyClassRespecs","name":"No Ascendancy respecs","description":"You cannot change your Ascendancy class once it has been chosen."}]},{"id":"Delirium Everywhere HC (NRE008)","realm":"pc","url":"https://www.pathofexile.com/ladders/league/Delirium+Everywhere+HC+%28NRE008%29","startAt":"2022-11-21T20:00:00Z","endAt":"2022-11-28T20:00:00Z","description":"Please check the Event Forums for more details.","registerAt":"2022-11-21T19:30:00Z","event":true,"rules":[{"id":"Hardcore","name":"Hardcore","description":"A character killed in Hardcore is moved to its parent league."},{"id":"NoAscendancyClassRespecs","name":"No Ascendancy respecs","description":"You cannot change your Ascendancy class once it has been chosen."}]},{"id":"Delirium Everywhere SSF (NRE009)","realm":"pc","url":"https://www.pathofexile.com/ladders/league/Delirium+Everywhere+SSF+%28NRE009%29","startAt":"2022-11-21T20:00:00Z","endAt":"2022-11-28T20:00:00Z","description":"Please check the Event Forums for more details.","registerAt":"2022-11-21T19:30:00Z","event":true,"rules":[{"id":"NoParties","name":"Solo","description":"You may not party in this league."},{"id":"NoAscendancyClassRespecs","name":"No Ascendancy respecs","description":"You cannot change your Ascendancy class once it has been chosen."}]},{"id":"Delirium Everywhere HC SSF (NRE010)","realm":"pc","url":"https://www.pathofexile.com/ladders/league/Delirium+Everywhere+HC+SSF+%28NRE010%29","startAt":"2022-11-21T20:00:00Z","endAt":"2022-11-28T20:00:00Z","description":"Please check the Event Forums for more details.","registerAt":"2022-11-21T19:30:00Z","event":true,"rules":[{"id":"Hardcore","name":"Hardcore","description":"A character killed in Hardcore is moved to its parent league."},{"id":"NoParties","name":"Solo","description":"You may not party in this league."},{"id":"NoAscendancyClassRespecs","name":"No Ascendancy respecs","description":"You cannot change your Ascendancy class once it has been chosen."}]}]}
  ).leagues as League[]).map(league=>(league.shortName= decodeURIComponent(last(league.url.split("/"))??""), league));
  return await (await axios.get<{leagues:League[]}>("https://api.pathofexile.com/league")).data.leagues
    .map(league=>(league.shortName= decodeURIComponent(last(league.url.split("/"))??""), league));
}